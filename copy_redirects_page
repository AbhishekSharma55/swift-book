#! /bin/zsh

# Copy the redirect "trampoline" page into every location where the
# legacy RST-based pipeline created an HTML page.
#
# Pass the path to the swift-book/ directory generated by DocC as this
# script's argument.  Run this script after running bin/publish-book
# when in the same directory as this script.

output=$1

if [[ ! -d $output ]]
then
    echo "Output directory doesn't exist" > /dev/stderr
    exit 1
fi

# Create directories.
mkdir $output/GuidedTour
mkdir $output/LanguageGuide
mkdir $output/ReferenceManual
mkdir $output/RevisionHistory

# Create redirect "trampolines".
cp redirect.html $output/GuidedTour/Compatibility.html
cp redirect.html $output/GuidedTour/GuidedTour.html
cp redirect.html $output/LanguageGuide/AccessControl.html
cp redirect.html $output/LanguageGuide/AdvancedOperators.html
cp redirect.html $output/LanguageGuide/AutomaticReferenceCounting.html
cp redirect.html $output/LanguageGuide/BasicOperators.html
cp redirect.html $output/LanguageGuide/ClassesAndStructures.html
cp redirect.html $output/LanguageGuide/Closures.html
cp redirect.html $output/LanguageGuide/CollectionTypes.html
cp redirect.html $output/LanguageGuide/Concurrency.html
cp redirect.html $output/LanguageGuide/ControlFlow.html
cp redirect.html $output/LanguageGuide/Deinitialization.html
cp redirect.html $output/LanguageGuide/Enumerations.html
cp redirect.html $output/LanguageGuide/ErrorHandling.html
cp redirect.html $output/LanguageGuide/Extensions.html
cp redirect.html $output/LanguageGuide/Functions.html
cp redirect.html $output/LanguageGuide/Generics.html
cp redirect.html $output/LanguageGuide/Inheritance.html
cp redirect.html $output/LanguageGuide/Initialization.html
cp redirect.html $output/LanguageGuide/MemorySafety.html
cp redirect.html $output/LanguageGuide/Methods.html
cp redirect.html $output/LanguageGuide/NestedTypes.html
cp redirect.html $output/LanguageGuide/OpaqueTypes.html
cp redirect.html $output/LanguageGuide/OptionalChaining.html
cp redirect.html $output/LanguageGuide/Properties.html
cp redirect.html $output/LanguageGuide/Protocols.html
cp redirect.html $output/LanguageGuide/StringsAndCharacters.html
cp redirect.html $output/LanguageGuide/Subscripts.html
cp redirect.html $output/LanguageGuide/TheBasics.html
cp redirect.html $output/LanguageGuide/TypeCasting.html
cp redirect.html $output/ReferenceManual/AboutTheLanguageReference.html
cp redirect.html $output/ReferenceManual/Attributes.html
cp redirect.html $output/ReferenceManual/Declarations.html
cp redirect.html $output/ReferenceManual/Expressions.html
cp redirect.html $output/ReferenceManual/GenericParametersAndArguments.html
cp redirect.html $output/ReferenceManual/LexicalStructure.html
cp redirect.html $output/ReferenceManual/Patterns.html
cp redirect.html $output/ReferenceManual/Statements.html
cp redirect.html $output/ReferenceManual/Types.html
cp redirect.html $output/ReferenceManual/zzSummaryOfTheGrammar.html
cp redirect.html $output/RevisionHistory/RevisionHistory.html
